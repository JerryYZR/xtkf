<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Lei Shi">
    <meta http-equiv="Cache-Control" content="o-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta name="csrf-token" content="1483780974##87f89328c5616669f00302a263fe9061bb852818">


    <title>讨论区 - 知客</title>

    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="styles/font-awesome.min.css">
    <link rel="stylesheet" href="styles/monokai-sublime.min.css">
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles/katex.min.css">
    <link rel="stylesheet" href="styles/video-js.min.css">
    <link rel="stylesheet" href="temp/styles.css">

    <style>
        @font-face {
            font-family: "lantingxihei";
            src: url("../fonts/FZLTCXHJW.TTF");
        }

        /* modal 模态框*/
        #invite-user .modal-body {
            overflow: hidden;
        }
        #invite-user .modal-body .form-label {
            margin-bottom: 16px;
            font-size:14px;
        }
        #invite-user .modal-body .form-invite {
            width: 80%;
            padding: 6px 12px;
            background-color: #eeeeee;
            border: 1px solid #cccccc;
            border-radius: 5px;
            float: left;
            margin-right: 10px;
        }
        #invite-user .modal-body .msg-modal-style {
            background-color: #7dd383;
            margin-top: 10px;
            padding: 6px 0;
            text-align: center;
            width: 100%;
        }
        #invite-user .modal-body .modal-flash {
            position: absolute;
            top: 53px;
            right: 74px;
            z-index: 999;
        }
        /* end modal */

        .en-footer {
            padding: 30px;
            text-align: center;
            font-size: 14px;
        }
        .btn{
            background: #0086B3;
        }


    </style>



</head>

<body>


<nav class="navbar navbar-default navbar-fixed-top header" style="background: #FFFFFF;">
    <div class="container" >
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-navbar-collapse" aria-expanded="false">
                <span class="sr-only">知课</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">
                <!--<img src="../img/logo_03.png">-->
            </a>
        </div>
        <div class="collapse navbar-collapse" id="header-navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="">
                    <a href="../paths/index.html">首页</a>
                </li>
                <li class="">
                    <a href="../paths/index.html">路径</a>
                </li>
                <li class="">
                    <a href="index.html">讨论区</a>
                </li>
                <li class=" bootcamp new-nav logo-1111">
                    <a href="../bootcamp/index.html">关于我们</a>

                </li>
                <!--<li class=" new-nav logo-1111">
                    <a href="../vip/index.html">会员</a>-->

                </li>

            </ul>


            <div class="navbar-right btns">
                <a class="btn btn-default navbar-btn sign-in" data-sign="signin" href="#sign-modal" data-toggle="modal">登录</a>
                <a class="btn btn-default navbar-btn sign-up" data-sign="signup" href="#sign-modal" data-toggle="modal">注册</a>
            </div>


            <form class="navbar-form navbar-right" action="../search" method="get" role="search">
                <div class="form-group">
                    <input type="text" class="form-control" name="search" autocomplete="off" placeholder="搜索 讨论组/标签">
                </div>
            </form>
        </div>
    </div>
</nav>



<div class="container layout layout-margin-top">


    <div class="row">
        <div class="col-md-9 layout-body">

            <div class="content">

                <ul class="nav nav-tabs question-types" role="tablist" >

                    <li role="presentation" class="active">
                        <a aria-controls="all" role="tab" toggle="tab">全部</a>
                    </li>

                    <div id="discusslabel">   </div>

                </ul>
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active">

                        <ul class="row question-items">


                            <div id="discusslist"></div>

                            <li class="question-item" id="bigData">
                                <div class="col-md-10">
                                    <div class="col-sm-2 question-item-author">
                                        <div class="user-avatar ">
                                            <a class="avatar"  target="_blank">
                                                <img src="https://dn-simplecloud.shiyanlou.com/gravataradmin.png?imageView2/1/w/100/h/100">
                                            </a>
                                        </div>
                                    </div>
                                    <div class="col-sm-10">
                                        <h4>
                                            <a class="question-item-title"  target="_blank"> 大数据分析讨论组</a>
                                        </h4>
                                        <div class="question-item-summary">

                                            <div class="user-username ">

                                                <span class="question-item-date">成员数：</span>
                                                <a class="avatar"  target="_blank">
                                                    30人
                                                </a>
                                            </div>
                                            <span class="question-item-date">3小时前</span>
                                            最后回复 <span class="question-item-date">
    <div class="user-username ">
        <a class="username" href="/user/256544" target="_blank">
                芃逆明
        </a>
        <span class="user-level">L38</span>
    </div>
 </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 question-item-rank">
                                    <div class="question-item-answered">
                                        <div>+进入讨论</div>

                                    </div>
                                </div>
                            </li>

                        </ul>




                        <nav class="pagination-container">
                            <ul class="pagination">

                                <li class="disabled">
                                    <a href="#" aria-label="Previous">
                                        <span aria-hidden="true">上一页</span>
                                    </a>
                                </li>
                                <li class="active">
                                    <a href="/questions/?sort=newest&amp;page=1&amp;area_type=all">1</a>
                                </li>
                                <li class="">
                                    <a href="/questions/?sort=newest&amp;page=2&amp;area_type=all">2</a>
                                </li>
                                <li class="">
                                    <a href="/questions/?sort=newest&amp;page=3&amp;area_type=all">3</a>
                                </li>
                                <li class="">
                                    <a href="/questions/?sort=newest&amp;page=4&amp;area_type=all">4</a>
                                </li>
                                <li class="">
                                    <a href="/questions/?sort=newest&amp;page=5&amp;area_type=all">5</a>
                                </li>
                                <li>
                                    <a href='#'>...</a>
                                </li>


                                <li class="">
                                    <a href="/questions/?sort=newest&amp;page=547&amp;area_type=all">547</a>
                                </li>



                                <li class="">
                                    <a href="/questions/?sort=newest&amp;page=548&amp;area_type=all">548</a>
                                </li>



                                <li class="">
                                    <a aria-label="Next" href="/questions/?sort=newest&amp;page=2&amp;area_type=all">
                                        <span aria-hidden="true">下一页</span>
                                    </a>
                                </li>

                            </ul>
                        </nav>



                    </div>
                </div>
            </div>

        </div>
        <div class="col-md-3 layout-side">


            <div class="panel panel-default panel-userinfo">
                <div class="panel-body body-userinfo">
                    <div class="media userinfo-header">
                        <div class="media-left">
                            <div class="user-avatar">

                                <a class="avatar" href="#sign-modal" data-toggle="modal" data-sign="signin">
                                    <img id="user_image" class="circle">
                                </a>

                            </div>
                        </div>
                        <div class="media-body">

                            <span class="media-heading username" id="username">李玉清</span>
                            <p class="vip-remain" id="signature">做最好的自己 ！</p>

                        </div>
                    </div>

                    <div class="row userinfo-data" >

                        <hr>
                        <div >
                            <p>个人资料</p>
                            <p id="major">计算机科学与技术</p>
                            <p id="speciality">擅长Android前端开发</p>
                        </div>

                    </div>

                    <div class="userinfo-footer row">
                        <div class="col-md-6 col-xs-6 pos-left">
                            参与课程数
                            <a id="coursenum"><span class="glyphicon glyphicon-bookmark"></span> 10</a>

                        </div>
                        <div class="col-md-6 col-xs-6 pos-right">
                            参加讨论组数
                            <a id="discussnum"><span class="glyphicon glyphicon-send"></span> 20</a>
                        </div>

                    </div>
                </div>
            </div>

            <div class="sidebox">

                <div class="sidebox-header">

                    <h4 class="sidebox-title">正在学习的路径</h4>

                </div>
                <div class="sidebox-body course-content side-list-body">
                    <ul style="list-style-type:none">
                        <div id="courselist"></div>
                        <li><a> Python 研发工程师</a></li>
                    </ul>
                </div>

            </div>
            <div class="sidebox">


                <div class="sidebox-header">
                    <h4 class="sidebox-title">参与的讨论组</h4>
                </div>
                <div class="sidebox-body course-content side-list-body">
                    <ul id="userdiscusslist" style="list-style-type:none">
                        <li><a > 信息安全工程师</a></li>
                    </ul>
                </div>

            </div>



        </div>
    </div>
</div>

</div>


<div id="base-data" data-flash="false"
     data-is-login=false
     data-is-jwt=true
     data-socket-url="wss://comet.shiyanlou.com"
     data-msg-user=""
     data-msg-system="">
</div>




<script src="temp/lib.js?=2016121272249"></script>
<script src="vendor/jquery/jquery.min.js"></script>
<script src="temp/highlight.min.js"></script>
<script src="temp/bootstrap-tour.min.js"></script>
<script src="temp/bootstrap-table.min.js"></script>
<script src="temp/bootstrap-table-zh-CN.min.js"></script>
<script src="temp/bootstrap-table-filter-control.min.js"></script>


<div id="jinja-data"

     data-question-form="/questions/meta"
     data-is-authenticated="false"
     data-login-url="/login?next=%2Fquestions%2F"
     data-qiniu-token-url="/api/qiniu/token"
     data-userid=""
>
</div>

<script src="temp/index.js?=2016121272249"></script>

<div class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-4 clearfix footer-col">
                <img src="image/lou-level.png">
                <div class="footer-slogan">欢迎来到讨论区！</div>

            </div>
            <div class="col-xs-6 col-sm-3 col-md-2 footer-col">
                <div class="col-title">公司</div>
                <a href="../aboutus/index.html" target="_blank">关于我们</a><br>
                <a href="../contact/index.html" target="_blank">联系我们</a><br>
                <a href="http://www.simplecloud.cn/jobs.html" target="_blank">加入我们</a><br>
                <a href="https://blog.shiyanlou.com" target="_blank">技术博客</a><br>
            </div>
            <div class="col-xs-6 col-sm-3 col-md-2 footer-col">
                <div class="col-title">合作</div>
                <a href="../contribute/index.html" target="_blank">我要投稿</a><br>
                <a href="../labs/index.html" target="_blank">教师合作</a><br>
                <a href="../edu/index.html" target="_blank">高校合作</a><br>
                <a href="../friends/index.html" target="_blank">友情链接</a>
            </div>
            <div class="col-xs-6 col-sm-3 col-md-2 footer-col">
                <div class="col-title">服务</div>
                <a href="../bootcamp/index.html" target="_blank">实战训练营</a><br>
                <a href="../vip/index.html" target="_blank">会员服务</a><br>
                <a href="../courses/reports/index.html" target="_blank">实验报告</a><br>
                <a href="index.html?tag=%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" target="_blank">常见问题</a><br>
                <a href="../privacy/index.html" target="_blank">隐私条款</a>
            </div>
            <div class="col-xs-6 col-sm-3 col-md-2 footer-col">
                <div class="col-title">学习路径</div>
                <a href="../paths/python/index.html" target="_blank">Python学习路径</a><br>
                <a href="../paths/linuxdev/index.html" target="_blank">Linux学习路径</a><br>
                <a href="../paths/bigdata/index.html" target="_blank">大数据学习路径</a><br>
                <a href="../paths/java/index.html" target="_blank">Java学习路径</a><br>
                <a href="../paths/php/index.html" target="_blank">PHP学习路径</a><br>
                <a href="../paths/index.html", target="_blank">全部</a>
            </div>
        </div>
    </div>

</div>
<script src="scripts/util.js"></script>
<script>


    //获取从上一个页面传递过来Id
    //获取从上个页面传过来的参数
    var loc = location.href;
    var n1 = loc.length;//地址的总长度
    var n2 = loc.indexOf("=");//取得=号的位置
    var n3 = loc.indexOf("&");
    var n4 = loc.lastIndexOf("=");//取得最后一个=号的位置
    var str1 = decodeURI(loc.substr(n2+1, n3-n2-1));//从=号后面获取userId
    var str2 = decodeURI(loc.substr(n4+1, n1-n4-1));//从另一个等号后面获取其他Id
    //var userId=str1;
    var userId=1;
    var discussId=2;
    $(function(){

        //获取用户相关信息
        //包括姓名，个性签名，专业，擅长领域（可不加），参与路径（课程）数，参与讨论组数
        var userformData=new FormData();
        userformData.append("id",userId);
        var user=getResponse("/user",userformData,"multipart/form-data", "post");
        console.log(user)
        $("#username").text(user.responseJSON.username);
        $("#signature").text(user.responseJSON.signature);
        $("#major").text(user.responseJSON.major);
        $("#speciality").text(user.responseJSON.speciality);
        $("#coursenum").text(user.responseJSON.coursenum);
        $("#discussnum").text(user.responseJSON.discussnum);

        $("#user_image").attr({
            "src" : "image/" + user.responseJSON.image_url
        });

        //获取正在学习的路径（路径这边没找到对应接口地址）
        var pathformData=new FormData();
        pathformData.append("userId",userId);
        var path=getResponse("/path/gatPathList",pathformData,"multipart/form-data", "post");
        var coursetmp1='';
        for(var i=0;i<path.responseJSON.length;i++){
            coursetmp1+='<li><a href="#">'+path.responseJSON[i].name+'</a></li>';
        }
        document.getElementById("courselist").innerHTML=coursetmp1;

        //获取正在参加的讨论组（列出参加的讨论组名称）
        var discussformData=new FormData();
        discussformData.append("id",userId);
        var discuss=getResponse("/user/discusses/userId",discussformData,"multipart/form-data", "post");
        console.log(discuss)
        var coursetmp2='';
        for(var i=0;i<discuss.responseJSON.length;i++){
            coursetmp2+='<li><a href="#">'+discuss.responseJSON[i].name+'</a></li>';
        }
        document.getElementById("userdiscusslist").innerHTML=coursetmp2;

        //获取所有讨论组信息
        var alldiscussformData=new FormData();
        var alldiscuss=getResponse("/discusses",alldiscussformData,"multipart/form-data", "get");
        console.log(alldiscuss)
        var coursetmp3='';
        for(var i=0;i<alldiscuss.responseJSON.length;i++){
            //有点长，加载的样式在159-199行（图片先不放了）
            coursetmp3+='<li class="question-item" id="bigData">'+
                '<div class="col-md-10"><div class="col-sm-2 question-item-author">'+
                '<div class="user-avatar "><a class="avatar"  target="_blank">'+
                '<img src="https://dn-simplecloud.shiyanlou.com/gravataradmin.png?imageView2/1/w/100/h/100">'+
                '</a></div></div><div class="col-sm-10"><h4><a class="question-item-title"  target="_blank">'+
                alldiscuss.responseJSON[i].name+'</a></h4><div class="question-item-summary"><div class="user-username ">'
                +'<span class="question-item-date">成员数：</span><a class="avatar"  target="_blank">'+
                alldiscuss.responseJSON[i].discussNum+'</a></div>'+
                '<span class="question-item-date">'+alldiscuss.responseJSON[i].create_time+
                '</span>最后回复 <span class="question-item-date"><div class="user-username ">'+
                '<a class="username" href="/user/256544" target="_blank">'+alldiscuss.responseJSON[i].quizzer+
                '</a><span class="user-level">L38</span></div></span></div></div></div><div class="col-md-2 question-item-rank">'
                +'</div></li>';

        }
        document.getElementById("discusslist").innerHTML=coursetmp3;

        //获取分类条件下的讨论组信息（没找到入口）
        $(".active").click(function(){
            var discussformData=new FormData();
            //获取被点击事件的内容（即分类标签）
            var str=$(this).text();
            discussformData.append("label",str);
            var category=getResponse("/discuss/getCategorydiscussList",discussformData,"multipart/form-data");
            var coursetmp4='';
            for(var i=0;i<category.responseJSON.length;i++){
                //加载的样式如上一个
                coursetmp4+= 't';
            }
            document.getElementById("discusslist").innerHTML=coursetmp3;
        });

        //获取所有标签内容(没找到入口)
        var labelformData=new FormData();
        var label=getResponse("/labellist");
        var coursetmp5='';
        for(var i=0;i<label.responseJSON.length;i++){
            //加载的样式如下，在145-147行
            coursetmp3+='<li role="presentation" class="active"><a href="#course"  aria-controls="course" role="tab" toggle="tab">'
                +label.responseJSON[i].name+'</a></li>';
        }
        document.getElementById("discusslabel").innerHTML=coursetmp5;

    });
    //讨论组点击跳转并将被点击的讨论组名称传给下一个页面
    $(".question-item-title").click(function(){
        location.href="questions.html?"+"userId="+userId+"&discussId="+discussId;
    });
    /*
    window.onload=function(ev){
         var oBtn=document.querySelector("button");

         oBtn.onclick=function(evl){
             $.ajax({
                 type:"get",
                 url:"",
                 data:"userName=sd&userPas=123456",
                 async:true,
                 timeout:3000,
                 success:function(msg){
                     alert(msg);
                 },
                 error:function(msg){
                     alert();
                 }

             });
         }
    }
    */
</script>
</body>
</html>